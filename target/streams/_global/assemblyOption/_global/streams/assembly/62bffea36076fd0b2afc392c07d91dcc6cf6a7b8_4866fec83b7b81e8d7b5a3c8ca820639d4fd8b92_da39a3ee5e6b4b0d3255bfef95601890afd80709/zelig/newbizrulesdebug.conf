rules {
  catalogs {

    c1: ["iPhone XS", "iPhone XR", "iPhone 8", "Galaxy 8", "Dell Latitud 7490", "Samsung A3", "Mouse Logitech MX2S"]
    c2: ["iPad Pro", "Pixel Slate", "Surface Pro", "Dell Latitud 7490", "Samsung A3", "Mouse Logitech MX2S"]

  }

  channels {
    WEB {
      placements {
        homepage_best_for_you { #P1
          recsNeeded: 5
          provider: "urprovider_bestforyou"
          #// Mejores recomendaciones para vos
        }

        #P2: cuando lo tengamos

        productpage_similar_products { #P3
          recsNeeded: 5
          provider: "urprovider_similar_items_with_item_categories"
        }

        productpage_similar_promoted_products { #P4
          recsNeeded: 5
          provider: "urprovider_similar_promoted_items"
          placementArgs: {
            campaign: "oferta1"
          }
        }

        productpage_freq_together { #P5
          recsNeeded: 5
          provider: "urprovider_freq_purchase_together"
           #// Página de producto. Frecuentemente comprados juntos
        }

        #P6: cuando lo tengamos

        cartpage_last_item_freq_together { #P7
          recsNeeded: 5
          provider: "urprovider_freq_purchase_together"
        }

        cartpage_user_purchases { #P8
          recsNeeded: 5
          provider: "urprovider_purchases_by_user"
        }

        cartpage_freq_together { #P9
          recsNeeded: 5
          provider: "urprovider_freq_purchase_together_itemset"
           #// Página de carrito. Freq comprados juntos
         }

        categoriespage_best_for_you { #P10
          recsNeeded: 5
          provider: "urprovider_bestforyou_categories"
           #// Página de categoria. best for you
        }

        fallback {
          recsNeeded: 1
          provider: "urprovider_freq_purchase_together"
        }
      }
    }
    BATCH {
      placements {
        ALLRECS {
          provider: "fallback_provider"
          recsNeeded: 1000
        }
        fallback {
          provider: "fallback_provider"
        }
      }
    }

  }

  providers {

    default { #definir default
      providerType: "OrderedList"
      list: ["PAT"]
    }

    fallback_provider { #definir fallback
      providerType: "OrderedList"
      list: ["PAT"]
    }

    urprovider_bestforyou{ #P1
      providerType: "UniversalRecommender"
      name: "URProvider_bestforyou",
      modelName: "purchases_views_carts_by_user",
      specifyUser: true,
      specifyItemSet: false,
      oUserBias: "",
      specifyItem: false,
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      acceptedParameters: ["user"],
      rules: [
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

    #P2 a definir

    urprovider_similar_items_with_item_categories { #P3
      providerType: "UniversalRecommender"
      name: "urprovider_similar_items_with_categories",
      modelName: "purchases_views_carts_by_user",
      specifyUser: false,
      specifyItemSet: false,
      oUserBias: "",
      specifyItem: true,
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      findItemAttributes: ["categories"],
      acceptedParameters: ["item"],
      rules: [
        {
            categories: ["$categories"]
            bias: 100
        },
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

    urprovider_similar_promoted_items { #P4
      providerType: "UniversalRecommender",
      name: "urprovider_similar_promoted_items",
      modelName: "purchases_views_carts_by_user",
      specifyUser: false,
      specifyItemSet: false,
      oUserBias: "",
      specifyItem: true,
      findItemAttributes: ["categories"],
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      acceptedParameters: ["item", "campaign"],
      rules: [
        {
            campaign: ["$campaign"],
            bias: -1 #esto obliga a que vayan productos de la misma campaign
        },
        {
            categories: ["$categories"],
            bias: 10 #esto boostea a los productos dentro de esta categoria
        },
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

    urprovider_freq_purchase_together { #P5 y P7
      providerType: "UniversalRecommender"
      name: "URProvider_Freq_Purchase_Together",
      modelName: "purchases_by_cart",
      specifyUser: false,
      specifyItemSet: false,
      oUserBias: "",
      specifyItem: true,
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      acceptedParameters: ["item"],
      rules: [
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

    #P6 a definir

    #P7: ver P5

    urprovider_purchases_by_user { #P8
      providerType: "UniversalRecommender",
      name: "urprovider_purchases_by_user",
      modelName: "purchases_by_user",
      specifyUser: false,
      specifyItemSet: true,
      oUserBias: "",
      specifyItem: false,
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      acceptedParameters: ["itemSet"],
      rules: [
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

    urprovider_freq_purchase_together_itemset { #P9
      providerType: "UniversalRecommender"
      name: "URProvider_Freq_Purchase_Together",
      modelName: "purchases_by_cart",
      specifyUser: false,
      specifyItemSet: true,
      oUserBias: "",
      specifyItem: false,
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      acceptedParameters: ["itemSet"],
      rules: [
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

    urprovider_bestforyou_categories{ #P10
      providerType: "UniversalRecommender"
      name: "URProvider_bestforyou_categories",
      modelName: "purchases_views_carts_by_user",
      specifyUser: true,
      specifyItemSet: false,
      oUserBias: "",
      specifyItem: false,
      oItemSetBias: "",
      oItemBias: "",
      oReturnSelf: "",
      acceptedParameters: ["user", "categories"],
      rules: [
        {
            categories: ["$categories"]
            bias: -1
        },
        {
          stock: ["yes"]
          bias: -1
        }
      ]
    }

  }

  rules: [

    {
        "affectedProducts": ["UR"],
        provider: "urprovider",
        "channels": [],
        "classname": "UniversalRecommender",
        "id": "ur-rule-test",
        "last": false,
        "placements": [],

    }
  ]
}

